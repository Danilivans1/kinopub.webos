(this["webpackJsonpkinopub.webos"]=this["webpackJsonpkinopub.webos"]||[]).push([[19],{517:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i,r=n(20),o=n(520),c=n.n(o),u=n(21),a=Object(u.b)(c.a)(i||(i=Object(r.a)([""])))},547:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(6),r=n(31),o=n(0),c=n(557),u=n.n(c),a=n(146),s=n(1),l=function(e){var t=e.visible,n=e.onVisibilityChange,c=Object(r.a)(e,["visible","onVisibilityChange"]),l=Object(o.useCallback)((function(){n(!0)}),[n]),d=Object(o.useCallback)((function(){n(!1)}),[n]);return Object(o.useEffect)((function(){var e=function(e){Object(a.b)(e)&&t&&(e.stopPropagation(),n(!1))};return window.addEventListener("keydown",e,!0),function(){window.removeEventListener("keydown",e,!0)}}),[t,n]),Object(s.jsx)(u.a,Object(i.a)(Object(i.a)({},c),{},{open:t,onShow:l,onClose:d}))}},558:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return b}));var i=n(523),r=n.n(i),o=n(102),c=n.n(o),u=n(579),a=n.n(u),s=function(e){return e<10?"0".concat(e):e};function l(e){return c()(e,(function(e,t){var n,i,o,c,u,l,d;return{lang:e.lang,name:r()(["".concat(s(t+1),"."),(null===(n=e.type)||void 0===n?void 0:n.title)&&(null===(i=e.author)||void 0===i?void 0:i.title)?"".concat(null===(o=e.type)||void 0===o?void 0:o.title,"."):null===(c=e.type)||void 0===c?void 0:c.title,null===(u=e.author)||void 0===u?void 0:u.title,(null===(l=e.type)||void 0===l?void 0:l.title)||(null===(d=e.author)||void 0===d?void 0:d.title)?"(".concat(a()(e.lang),")"):a()(e.lang),"aac"!==e.codec&&a()(e.codec)]).join(" ")}}))}function d(e,t){return c()(e,(function(e){return{src:"string"===typeof e.url?e.url:e.url[t]||e.url.http,name:e.quality}}))}function b(e){return c()(e,(function(e,t){return{src:e.url,lang:e.lang,name:"".concat(a()(e.lang)," #").concat(s(t+1))}}))}},559:function(e,t,n){"use strict";n.d(t,"a",(function(){return te}));var i=n(6),r=n(46),o=n(31),c=n(20),u=n(0),a=n(570),s=n.n(a),l=n(21),d=n(42),b=n(43),f=n(583),v=n(113),h=n(85),j=n(84),p=n(553),O=n.n(p),m=n(575),k=n.n(m),T=n(576),g=n.n(T),y=n(532),x=n.n(y),w=n(15),E=n.n(w),L=n(29),C=function(){function e(t){Object(d.a)(this,e),this.resource=void 0,this.objectURL=void 0,this.resource=t}return Object(b.a)(e,[{key:"blobToBuffer",value:function(){var e=this;return new Promise((function(t,n){var i=new FileReader;i.addEventListener("loadend",(function(e){var n,i=null===(n=e.target)||void 0===n?void 0:n.result;t(new Uint8Array(i))})),i.addEventListener("error",(function(){return n("Error while reading the Blob object")})),i.readAsArrayBuffer(e.resource)}))}},{key:"getURL",value:function(){var t=this;return new Promise((function(n,i){return t.resource instanceof Blob?FileReader?TextDecoder?e.blobToString(t.resource,(function(i){var r="WEBVTT FILE\r\n\r\n".concat(e.toVTT(i)),o=new Blob([r],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(o),n(t.objectURL)}),(function(){t.blobToBuffer().then((function(i){var r=new TextDecoder("utf-8").decode(i),o="WEBVTT FILE\r\n\r\n".concat(e.toVTT(r)),c=new Blob([o],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(c),n(t.objectURL)}))})):i("No TextDecoder constructor found"):i("No FileReader constructor found"):i("Expecting resource to be a Blob but something else found.")}))}},{key:"release",value:function(){URL.createObjectURL(this.objectURL)}}],[{key:"blobToString",value:function(e,t,n){var i=new FileReader;i.addEventListener("loadend",(function(e){var n,i=null===(n=e.target)||void 0===n?void 0:n.result;t(i)})),i.addEventListener("error",(function(){return n()})),i.readAsText(e)}},{key:"toVTT",value:function(e){return e.replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").concat("\r\n\r\n")}},{key:"toTypedArray",value:function(e){var t=[];return e.split("").forEach((function(e){t.push(parseInt("".concat(e.charCodeAt(0)),16))})),Uint8Array.from(t)}}]),e}();function R(){return(R=Object(L.a)(E.a.mark((function e(t){var n,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.blob();case 4:return n=e.sent,i=new C(n),e.abrupt("return",i.getURL());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U,A,S,B,P,M,V,D=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(d.a)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).hls=void 0,e.media=void 0,e.state=void 0,e.props=void 0,e}return Object(b.a)(n,[{key:"load",value:function(e){var t=this;this.destroy();var n=this.media;if(this.setState({src:e}),e.includes(".m3u8")&&k.a.isSupported()){var i=this.hls=new k.a;return i.attachMedia(n),void i.on(k.a.Events.MEDIA_ATTACHED,(function(){i.loadSource(e),i.on(k.a.Events.MANIFEST_PARSED,(function(){t.play()}))}))}n.src=e,n.addEventListener("loadedmetadata",(function(){t.play()}))}},{key:"audioTracks",get:function(){var e;return this.hls?g()(this.hls.audioTracks.map((function(e){return e.name}))):null===(e=this.props.audioTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"audioTrack",get:function(){var e,t,n,i=this;if(this.hls)return null===(n=this.hls.audioTracks.find((function(e){var t;return e.id===(null===(t=i.hls)||void 0===t?void 0:t.audioTrack)})))||void 0===n?void 0:n.name;var r=Array.from(this.media.audioTracks||[]).findIndex((function(e){return e.enabled}));return null===(e=this.props.audioTracks)||void 0===e||null===(t=e[r])||void 0===t?void 0:t.name},set:function(e){if(this.hls){var t=this.hls.audioTracks.find((function(t){return t.name===e}));t&&(this.hls.audioTrack=t.id)}else{var n,i=Array.from(this.media.audioTracks||[]),r=null===(n=this.props.audioTracks)||void 0===n?void 0:n.findIndex((function(t){return t.name===e}));(!r||r>i.length-1)&&(r=0),i.forEach((function(e,t){e.enabled=t===r}))}}},{key:"sourceTracks",get:function(){return x()(this.props.sourceTracks,"src").map((function(e){return e.name}))}},{key:"sourceTrack",get:function(){var e,t=this;return null===(e=this.props.sourceTracks.find((function(e){return e.src===t.state.src})))||void 0===e?void 0:e.name},set:function(e){var t=this.props.sourceTracks.find((function(t){return t.name===e}));t&&this.load(t.src)}},{key:"subtitleTracks",get:function(){var e;return this.hls?this.hls.subtitleTracks.map((function(e){return e.name})):null===(e=this.props.subtitleTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"subtitleTrack",get:function(){var e,t,n=this;return this.hls?null===(t=this.hls.subtitleTracks.find((function(e){var t;return e.id===(null===(t=n.hls)||void 0===t?void 0:t.subtitleTrack)})))||void 0===t?void 0:t.name:null===(e=Array.from(this.media.textTracks||[]).find((function(e){return"showing"===e.mode})))||void 0===e?void 0:e.label},set:function(e){if(this.hls){var t,n;this.hls.subtitleTrack=null!==(t=null===(n=this.hls.subtitleTracks.find((function(t){return t.name===e})))||void 0===n?void 0:n.id)&&void 0!==t?t:-1}else{var i=Array.from(this.media.textTracks||[]);i.forEach((function(e){e.mode="disabled"}));var r=i.find((function(t){return t.label===e}));if(r)r.mode="showing";else{var o,c=null===(o=this.props.subtitleTracks)||void 0===o?void 0:o.find((function(t){return t.name===e}));if(c){var u=document.createElement("track");u.kind="captions",u.id=c.name,u.srclang=c.lang,u.label=c.name;var a=function(e){u.src=e,u.track.mode="showing"};c.src.endsWith(".srt")?function(e){return R.apply(this,arguments)}(c.src).then(a):a(c.src),this.media.appendChild(u)}}}}},{key:"destroy",value:function(){this.hls?this.hls.destroy():this.media.src=""}},{key:"componentDidMount",value:function(){var e;this.load(this.props.sourceTracks[0].src),null===(e=Object(f.a)(Object(v.a)(n.prototype),"componentDidMount",this))||void 0===e||e.call(this)}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){var e;this.destroy(),null===(e=Object(f.a)(Object(v.a)(n.prototype),"componentWillUnmount",this))||void 0===e||e.call(this)}}]),n}(O.a),F=n(517),I=n(548),N=n.n(I),$=n(102),W=n.n($),J=n(547),_=n(146),z=n(1),q="NONE",H=l.b.div(U||(U=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),G=l.b.div(A||(A=Object(c.a)(["\n  padding: 0 1rem;\n  display: flex;\n  flex-direction: column;\n"]))),K=Object(l.b)(F.a)(S||(S=Object(c.a)(["\n  width: 5rem;\n"]))),Q=l.b.div(B||(B=Object(c.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]))),X=l.b.div(P||(P=Object(c.a)(["\n  width: ",";\n  padding-right: 1rem;\n  box-sizing: border-box;\n"])),(function(e){return e.width})),Y=function(e){var t=e.player,n=Object(u.useState)(!1),i=Object(r.a)(n,2),o=i[0],c=i[1],a=Object(u.useState)([]),s=Object(r.a)(a,2),l=s[0],d=s[1],b=Object(u.useState)(null),f=Object(r.a)(b,2),v=f[0],h=f[1],j=Object(u.useState)([]),p=Object(r.a)(j,2),O=p[0],m=p[1],k=Object(u.useState)(null),T=Object(r.a)(k,2),g=T[0],y=T[1],x=Object(u.useState)([]),w=Object(r.a)(x,2),E=w[0],L=w[1],C=Object(u.useState)(null),R=Object(r.a)(C,2),U=R[0],A=R[1],S=Object(u.useCallback)((function(e,n){if(t.current){var i=t.current.getVideoNode(),r=i.currentTime;i[e]=n,setTimeout((function(){i.currentTime=r-1}),500)}}),[t]),B=Object(u.useCallback)((function(e){return function(){h(e),S("audioTrack",e)}}),[S]),P=Object(u.useCallback)((function(e){return function(){y(e),S("sourceTrack",e)}}),[S]),M=Object(u.useCallback)((function(e){return function(){A(e),S("subtitleTrack",e)}}),[S]),V=Object(u.useCallback)((function(e){c(e),t.current&&!e&&t.current.play()}),[t]);return Object(u.useEffect)((function(){var e=function(e){if(Object(_.a)(e)){if(t.current){var n=t.current.getVideoNode(),i=n.audioTracks,r=n.audioTrack,o=n.sourceTracks,u=n.sourceTrack,a=n.subtitleTracks,s=n.subtitleTrack;((null===i||void 0===i?void 0:i.length)>1||(null===o||void 0===o?void 0:o.length)>1||(null===a||void 0===a?void 0:a.length)>0)&&(d(i),h(r),m(o),y(u),L(a),A(s),t.current.pause(),c(!0))}}else Object(_.c)(e)&&c(!1)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[o,t]),Object(z.jsx)(J.a,{visible:o,onVisibilityChange:V,children:Object(z.jsxs)(H,{children:[(null===l||void 0===l?void 0:l.length)>1&&Object(z.jsxs)(G,{children:[Object(z.jsx)(K,{children:"\u0417\u0432\u0443\u043a"}),Object(z.jsx)(Q,{children:W()(l,(function(e){return Object(z.jsx)(X,{width:"50%",children:Object(z.jsx)(N.a,{selected:e===v,onToggle:B(e),children:e})},e)}))})]}),(null===O||void 0===O?void 0:O.length)>1&&Object(z.jsxs)(G,{children:[Object(z.jsx)(K,{children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(z.jsx)(Q,{children:W()(O,(function(e){return Object(z.jsx)(X,{width:"15%",children:Object(z.jsx)(N.a,{selected:e===g,onToggle:P(e),children:e})},e)}))})]}),(null===E||void 0===E?void 0:E.length)>0&&Object(z.jsxs)(G,{children:[Object(z.jsx)(K,{children:"\u0421\u0443\u0431\u0442\u0438\u0442\u0440\u044b"}),Object(z.jsxs)(Q,{children:[Object(z.jsx)(X,{width:"15%",children:Object(z.jsx)(N.a,{selected:!U||U===q,onToggle:M(q),children:"\u041d\u0435\u0442"})}),W()(E,(function(e){return Object(z.jsx)(X,{width:"15%",children:Object(z.jsx)(N.a,{selected:e===U,onToggle:M(e),children:e})},e)}))]})]})]})})},Z=l.b.div(M||(M=Object(c.a)(["\n  video {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n"]))),ee=Object(l.b)(F.a)(V||(V=Object(c.a)(["\n  position: absolute;\n  padding: 0 1rem;\n  z-index: 1;\n  visibility: ",";\n"])),(function(e){return e.visible?"visible":"hidden"})),te=function(e){var t=e.title,n=e.description,c=e.poster,a=e.audios,l=e.sources,d=e.subtitles,b=e.onPlay,f=e.onPause,v=e.onEnded,h=Object(o.a)(e,["title","description","poster","audios","sources","subtitles","onPlay","onPause","onEnded"]),j=Object(u.useRef)(),p=Object(u.useState)(!0),O=Object(r.a)(p,2),m=O[0],k=O[1],T=Object(u.useCallback)((function(){k(!1),null===b||void 0===b||b()}),[b]),g=Object(u.useCallback)((function(e){k(!0),null===f||void 0===f||f(e.currentTime)}),[f]),y=Object(u.useCallback)((function(e){null===v||void 0===v||v(e.target.currentTime)}),[v]);return Object(u.useEffect)((function(){m&&setTimeout((function(){k(!1)}),5e3)}),[m]),Object(z.jsxs)(Z,{children:[Object(z.jsx)(ee,{visible:m,children:t}),Object(z.jsx)(Y,{player:j}),Object(z.jsx)(s.a,Object(i.a)(Object(i.a)({},h),{},{ref:j,title:n,poster:c,jumpBy:10,onPlay:T,onPause:g,onEnded:y,audioTracks:a,sourceTracks:l,subtitleTracks:d,videoComponent:D}))]})}},581:function(e,t,n){"use strict";function i(e,t,n){return n?"".concat(null===e||void 0===e?void 0:e.title," (s").concat(n.number,"e").concat((null===t||void 0===t?void 0:t.number)||1,")"):null===e||void 0===e?void 0:e.title}n.d(t,"a",(function(){return i}))},734:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n(6),r=n(46),o=n(0),c=n(513),u=n(559),a=n(112),s=n(162),l=n(581),d=n(558),b=n(1),f=function(e,t,n){var i=function(e,t,n){return Object(o.useMemo)((function(){var i,r,o=null===(i=e.videos||(null===t||void 0===t?void 0:t.episodes))||void 0===i?void 0:i.find((function(e){return e.number===n.number+1}));if(o)return o;var c=null===(r=e.seasons)||void 0===r?void 0:r.find((function(e){return e.number===t.number+1}));return c?c.episodes[0]:void 0}),[e,t,n])}(e,t,n);return[function(e,t,n){return Object(o.useMemo)((function(){var i,r,o=null===(i=e.videos||(null===t||void 0===t?void 0:t.episodes))||void 0===i?void 0:i.find((function(e){return e.number===n.number-1}));if(o)return o;var c=null===(r=e.seasons)||void 0===r?void 0:r.find((function(e){return e.number===t.number-1}));return c?c.episodes[c.episodes.length-1]:void 0}),[e,t,n])}(e,t,n),i]},v=function(){var e=Object(c.e)(),t=Object(c.f)(),n=Object(a.a)("watchingMarkTime").watchingMarkTime,v=Object(s.a)("streaming_type"),h=Object(r.a)(v,1)[0],j=t.state,p=j.item,O=j.video,m=j.season,k=Object(o.useState)(O),T=Object(r.a)(k,2),g=T[0],y=T[1],x=f(p,m,g),w=Object(r.a)(x,2),E=w[0],L=w[1],C=Object(o.useCallback)((function(e,t){var i=e.number;n([p.id,t,i,null===m||void 0===m?void 0:m.number])}),[n,p,m]),R=Object(o.useMemo)((function(){return{title:Object(l.a)(p,g,m),description:g.title,poster:p.posters.wide||p.posters.big,audios:Object(d.a)(g.audios),sources:Object(d.b)(g.files,h),subtitles:Object(d.c)(g.subtitles)}}),[p,m,g,h]),U=Object(o.useCallback)((function(e){C(g,e)}),[C,g]),A=Object(o.useCallback)((function(t){C(g,t),L?y(L):e.goBack()}),[C,e,g,L]),S=Object(o.useCallback)((function(e){var t=e.currentTime;C(g,t),E&&y(E)}),[C,g,E]),B=Object(o.useCallback)((function(e){var t=e.currentTime;C(g,t),L&&y(L)}),[C,g,L]);return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(u.a,Object(i.a)(Object(i.a)({},R),{},{onPause:U,onEnded:A,onJumpBackward:S,onJumpForward:B}),g.id)})}}}]);
//# sourceMappingURL=19.e938b762.chunk.js.map