(this["webpackJsonpkinopub.webos"]=this["webpackJsonpkinopub.webos"]||[]).push([[20],{1062:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var c=n(11),r=n(2),a=n(31),i=n(930),o=n(888),u=n(928),s=n(3),l=function(){var e=Object(a.h)(),t=(Object(a.i)().state||{}).channel,n=Object(r.useMemo)((function(){return{title:t.title,poster:t.logos.m,sources:Object(u.b)([{url:{http:t.stream,hls4:t.stream}}])}}),[t]),l=Object(r.useCallback)((function(){e.goBack()}),[e]);return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(o.a,{title:"\u041a\u0430\u043d\u0430\u043b: ".concat(t.title)}),Object(s.jsx)(i.a,Object(c.a)(Object(c.a)({},n),{},{onEnded:l}))]})}},888:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(11),r=n(893),a=n(3),i=function(e){return Object(a.jsx)(r.a,Object(c.a)({defaultTitle:"Unknown",titleTemplate:"%s | Kinopub WebOS"},e))}},896:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var c=n(11),r=n(57),a=n(2),i=n(52),o=n.n(i),u=n(258),s=n(251),l=n(3),d=["icon","iconOnly","children","autoFocus","className"],b=function(e){var t=e.icon,n=e.iconOnly,i=e.children,b=e.autoFocus,f=e.className,j=Object(r.a)(e,d),v=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e;return b&&(e=requestAnimationFrame((function(){var e,t;null===(e=v.current)||void 0===e||null===(t=e.node)||void 0===t||t.focus()}))),function(){e&&cancelAnimationFrame(e)}}),[v,b]),Object(l.jsx)(s.a,Object(c.a)(Object(c.a)({},j),{},{ref:v,className:o()("text-gray-200 whitespace-nowrap cursor-pointer rounded px-2 py-1",f),role:"button",children:Object(l.jsxs)("div",{className:"flex items-center",children:[t&&Object(l.jsx)(u.a,{className:o()({"mr-2":!n}),name:t}),!n&&i]})}))}},900:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var c=n(11),r=n(57),a=n(2),i=n(52),o=n.n(i),u=n(251),s=n(3),l=["defaultChecked","checked","onChange","className","children"],d=function(e){var t=e.defaultChecked,n=e.checked,i=e.onChange,d=e.className,b=e.children,f=Object(r.a)(e,l),j=Object(a.useRef)(null),v=Object(a.useCallback)((function(e){null===i||void 0===i||i(e.target.checked,e)}),[i]),h=Object(a.useCallback)((function(){var e;null===(e=j.current)||void 0===e||e.click()}),[]);return Object(s.jsx)(u.a,{component:"label",className:o()("text-gray-200 p-2",d),onClick:h,role:"button",children:Object(s.jsxs)("div",{className:"inline-flex items-center cursor-pointer",children:[Object(s.jsx)("input",Object(c.a)(Object(c.a)({type:"checkbox"},f),{},{ref:j,className:"inline-block w-4 h-4",defaultChecked:t,checked:n,onChange:v})),Object(s.jsx)("span",{className:"inline-block ml-2 whitespace-nowrap",children:b})]})})}},921:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var c=n(11),r=n(57),a=n(2),i=n(257),o=n.n(i),u=n(52),s=n.n(u),l=n(924),d=n.n(l),b=n(3),f=d()({enterTo:"default-element",defaultElement:".spottable",selector:".spottable",overflow:!0,preserveId:!0},(function(e){return Object(b.jsx)("div",Object(c.a)({},e))})),j=n(256),v=["visible","onClose","className"],h=function(e){var t=e.visible,n=e.onClose,i=e.className,u=Object(r.a)(e,v),l=Object(a.useMemo)((function(){return o.a.add({})}),[]),d=Object(a.useCallback)((function(){n(!1)}),[n]),h=Object(a.useCallback)((function(){if(t)return d(),!1}),[t,d]),O=Object(a.useCallback)((function(){if(!o.a.focus(l)){var e=o.a.getCurrent();e&&e.blur(),o.a.setActiveContainer(l),setTimeout((function(){o.a.setPointerMode(!1),o.a.focus(l)}),500)}}),[l]);return Object(j.a)("Back",h),Object(j.a)("Blue",h),Object(a.useEffect)((function(){t&&O()}),[t,O]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:s()("fixed z-999 top-0 left-0 right-0 bottom-0 bg-black bg-opacity-50",{hidden:!t}),onClick:d}),Object(b.jsx)(f,Object(c.a)(Object(c.a)({},u),{},{spotlightId:l,spotlightRestrict:"self-only",spotlightDisabled:!t,className:s()("fixed z-999 bottom-0 left-0 right-0 p-4 bg-black ring",{hidden:!t},i)}))]})}},923:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(11),r=(n(2),n(900)),a=n(3),i=function(e){return Object(a.jsx)(r.a,Object(c.a)(Object(c.a)({},e),{},{type:"radio"}))}},928:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return j}));var c=n(897),r=n.n(c),a=n(193),i=n.n(a),o=n(929),u=n.n(o),s=n(947),l=n.n(s),d=function(e){return e<10?"0".concat(e):e};function b(e){return i()(e,(function(e,t){var n,c,a,i,o,u,s;return{lang:e.lang,name:r()(["".concat(d(t+1),"."),(null===(n=e.type)||void 0===n?void 0:n.title)&&(null===(c=e.author)||void 0===c?void 0:c.title)?"".concat(null===(a=e.type)||void 0===a?void 0:a.title,"."):null===(i=e.type)||void 0===i?void 0:i.title,null===(o=e.author)||void 0===o?void 0:o.title,(null===(u=e.type)||void 0===u?void 0:u.title)||(null===(s=e.author)||void 0===s?void 0:s.title)?"(".concat(l()(e.lang),")"):l()(e.lang),"aac"!==e.codec&&l()(e.codec)]).join(" ")}}))}function f(e,t){return u()(i()(e,(function(e){return{src:"string"===typeof e.url?e.url:e.url[t]||e.url.http,name:e.quality}})),(function(e){var t=e.name;return parseInt(t)}),"desc")}function j(e){return i()(e,(function(e,t){return{src:e.url,lang:e.lang,name:"".concat(l()(e.lang)," #").concat(d(t+1))}}))}},930:function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var c=n(11),r=n(32),a=n.n(r),i=n(53),o=n(73),u=n(57),s=n(2),l=n(937),d=n.n(l),b=n(84),f=n(85),j=n(958),v=n(197),h=n(157),O=n(156),m=n(926),p=n.n(m),k=n(941),x=n.n(k),T=n(942),g=n.n(T),y=n(898),C=n.n(y),w=function(){function e(t){Object(b.a)(this,e),this.resource=void 0,this.objectURL=void 0,this.resource=t}return Object(f.a)(e,[{key:"blobToBuffer",value:function(){var e=this;return new Promise((function(t,n){var c=new FileReader;c.addEventListener("loadend",(function(e){var n,c=null===(n=e.target)||void 0===n?void 0:n.result;t(new Uint8Array(c))})),c.addEventListener("error",(function(){return n("Error while reading the Blob object")})),c.readAsArrayBuffer(e.resource)}))}},{key:"getURL",value:function(){var t=this;return new Promise((function(n,c){return t.resource instanceof Blob?FileReader?TextDecoder?e.blobToString(t.resource,(function(c){var r="WEBVTT FILE\r\n\r\n".concat(e.toVTT(c)),a=new Blob([r],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(a),n(t.objectURL)}),(function(){t.blobToBuffer().then((function(c){var r=new TextDecoder("utf-8").decode(c),a="WEBVTT FILE\r\n\r\n".concat(e.toVTT(r)),i=new Blob([a],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(i),n(t.objectURL)}))})):c("No TextDecoder constructor found"):c("No FileReader constructor found"):c("Expecting resource to be a Blob but something else found.")}))}},{key:"release",value:function(){URL.createObjectURL(this.objectURL)}}],[{key:"blobToString",value:function(e,t,n){var c=new FileReader;c.addEventListener("loadend",(function(e){var n,c=null===(n=e.target)||void 0===n?void 0:n.result;t(c)})),c.addEventListener("error",(function(){return n()})),c.readAsText(e)}},{key:"toVTT",value:function(e){return e.replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").concat("\r\n\r\n")}},{key:"toTypedArray",value:function(e){var t=[];return e.split("").forEach((function(e){t.push(parseInt("".concat(e.charCodeAt(0)),16))})),Uint8Array.from(t)}}]),e}();function N(){return(N=Object(i.a)(a.a.mark((function e(t){var n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.blob();case 4:return n=e.sent,c=new w(n),e.abrupt("return",c.getURL());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).hls=void 0,e.media=void 0,e.state=void 0,e.props=void 0,e}return Object(f.a)(n,[{key:"load",value:function(e){var t,n=this.props.startTime;(null===(t=this.state)||void 0===t?void 0:t.src)&&this.state.src!==e&&(n=this.media.currentTime),this.destroy();var c=this.media;this.setState({src:e});var r=function(){n&&(c.currentTime=n),c.play()};if(e.includes(".m3u8")&&x.a.isSupported()){var a=this.hls=new x.a;return a.attachMedia(c),void a.on(x.a.Events.MEDIA_ATTACHED,(function(){a.loadSource(e),a.on(x.a.Events.MANIFEST_PARSED,r)}))}c.src=e,c.addEventListener("loadedmetadata",r)}},{key:"audioTracks",get:function(){var e;return this.hls?g()(this.hls.audioTracks.map((function(e){return e.name}))):null===(e=this.props.audioTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"audioTrack",get:function(){var e,t,n,c=this;if(this.hls)return null===(n=this.hls.audioTracks.find((function(e){var t;return e.id===(null===(t=c.hls)||void 0===t?void 0:t.audioTrack)})))||void 0===n?void 0:n.name;var r=Array.from(this.media.audioTracks||[]).findIndex((function(e){return e.enabled}));return null===(e=this.props.audioTracks)||void 0===e||null===(t=e[r])||void 0===t?void 0:t.name},set:function(e){if(this.hls){var t=this.hls.audioTracks.find((function(t){return t.name===e}));t&&(this.hls.audioTrack=t.id)}else{var n,c=Array.from(this.media.audioTracks||[]),r=null===(n=this.props.audioTracks)||void 0===n?void 0:n.findIndex((function(t){return t.name===e}));(!r||r>c.length-1)&&(r=0),c.forEach((function(e,t){e.enabled=t===r}))}}},{key:"sourceTracks",get:function(){return C()(this.props.sourceTracks,"src").map((function(e){return e.name}))}},{key:"sourceTrack",get:function(){var e,t=this;return null===(e=this.props.sourceTracks.find((function(e){return e.src===t.state.src})))||void 0===e?void 0:e.name},set:function(e){var t=this.props.sourceTracks.find((function(t){return t.name===e}));t&&this.load(t.src)}},{key:"subtitleTracks",get:function(){var e;return this.hls?this.hls.subtitleTracks.map((function(e){return e.name})):null===(e=this.props.subtitleTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"subtitleTrack",get:function(){var e,t,n=this;return this.hls?null===(t=this.hls.subtitleTracks.find((function(e){var t;return e.id===(null===(t=n.hls)||void 0===t?void 0:t.subtitleTrack)})))||void 0===t?void 0:t.name:null===(e=Array.from(this.media.textTracks||[]).find((function(e){return"showing"===e.mode})))||void 0===e?void 0:e.label},set:function(e){if(this.hls){var t,n;this.hls.subtitleTrack=null!==(t=null===(n=this.hls.subtitleTracks.find((function(t){return t.name===e})))||void 0===n?void 0:n.id)&&void 0!==t?t:-1}else{var c=Array.from(this.media.textTracks||[]);c.forEach((function(e){e.mode="disabled"}));var r=c.find((function(t){return t.label===e}));if(r)r.mode="showing";else{var a,i=null===(a=this.props.subtitleTracks)||void 0===a?void 0:a.find((function(t){return t.name===e}));if(i){var o=document.createElement("track");o.kind="captions",o.id=i.name,o.srclang=i.lang,o.label=i.name;var u=function(e){o.src=e,o.track.mode="showing"};i.src.endsWith(".srt")?function(e){return N.apply(this,arguments)}(i.src).then(u):u(i.src),this.media.appendChild(o)}}}}},{key:"destroy",value:function(){this.hls?this.hls.destroy():this.media.src=""}},{key:"componentDidMount",value:function(){var e;this.load(this.props.sourceTracks[0].src),null===(e=Object(j.a)(Object(v.a)(n.prototype),"componentDidMount",this))||void 0===e||e.call(this)}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){var e;this.destroy(),null===(e=Object(j.a)(Object(v.a)(n.prototype),"componentWillUnmount",this))||void 0===e||e.call(this)}}]),n}(p.a),S=n(252),R=n(256),L=n(193),A=n.n(L),U=n(896),B=n(921),I=n(923),F=n(3),D="NONE",P=function(e){var t=e.player,n=e.showButton,c=Object(s.useState)(!1),r=Object(o.a)(c,2),a=r[0],i=r[1],u=Object(s.useState)([]),l=Object(o.a)(u,2),d=l[0],b=l[1],f=Object(s.useState)(null),j=Object(o.a)(f,2),v=j[0],h=j[1],O=Object(s.useState)([]),m=Object(o.a)(O,2),p=m[0],k=m[1],x=Object(s.useState)(null),T=Object(o.a)(x,2),g=T[0],y=T[1],C=Object(s.useState)([]),w=Object(o.a)(C,2),N=w[0],E=w[1],L=Object(s.useState)(null),P=Object(o.a)(L,2),M=P[0],V=P[1],W=Object(s.useCallback)((function(e,n){t.current&&(t.current.getVideoNode()[e]=n)}),[t]),$=Object(s.useCallback)((function(e){return function(){h(e),W("audioTrack",e)}}),[W]),z=Object(s.useCallback)((function(e){return function(){y(e),W("sourceTrack",e)}}),[W]),q=Object(s.useCallback)((function(e){return function(){V(e),W("subtitleTrack",e)}}),[W]),J=Object(s.useCallback)((function(){if(t.current&&!a){var e=t.current.getVideoNode(),n=e.audioTracks,c=e.audioTrack,r=e.sourceTracks,o=e.sourceTrack,u=e.subtitleTracks,s=e.subtitleTrack;((null===n||void 0===n?void 0:n.length)>1||(null===r||void 0===r?void 0:r.length)>1||(null===u||void 0===u?void 0:u.length)>0)&&(b(n),h(c),k(r),y(o),E(u),V(s),t.current.pause(),i(!0))}}),[a,t]),_=Object(s.useCallback)((function(){i(!1),t.current&&t.current.play()}),[t]),H=Object(s.useCallback)((function(){!a&&J()}),[a,J]);return Object(R.a)("Blue",H),Object(R.a)("Play",_),Object(R.a)("ArrowUp",J),Object(F.jsxs)(F.Fragment,{children:[n&&Object(F.jsx)(U.a,{className:"absolute z-101 bottom-8 right-10",icon:"settings",iconOnly:!0,onClick:J}),Object(F.jsx)(B.a,{visible:a,onClose:_,children:Object(F.jsxs)("div",{className:"flex flex-col",children:[(null===d||void 0===d?void 0:d.length)>1&&Object(F.jsxs)("div",{className:"flex flex-col py-4",children:[Object(F.jsx)(S.a,{children:"\u0417\u0432\u0443\u043a"}),Object(F.jsx)("div",{className:"flex flex-wrap mt-2",children:A()(d,(function(e){return Object(F.jsx)("div",{className:"w-1/2",children:Object(F.jsx)(I.a,{checked:e===v,onChange:$(e),children:e})},e)}))})]}),(null===p||void 0===p?void 0:p.length)>1&&Object(F.jsxs)("div",{className:"flex flex-col py-4",children:[Object(F.jsx)(S.a,{children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(F.jsx)("div",{className:"flex flex-wrap mt-2",children:A()(p,(function(e){return Object(F.jsx)("div",{className:"w-1/6",children:Object(F.jsx)(I.a,{checked:e===g,onChange:z(e),children:e})},e)}))})]}),(null===N||void 0===N?void 0:N.length)>0&&Object(F.jsxs)("div",{className:"flex flex-col py-4",children:[Object(F.jsx)(S.a,{children:"\u0421\u0443\u0431\u0442\u0438\u0442\u0440\u044b"}),Object(F.jsxs)("div",{className:"flex flex-wrap mt-2",children:[Object(F.jsx)("div",{className:"w-1/6",children:Object(F.jsx)(I.a,{checked:!M||M===D,onChange:q(D),children:"\u041d\u0435\u0442"})}),A()(N,(function(e){return Object(F.jsx)("div",{className:"w-1/6",children:Object(F.jsx)(I.a,{checked:e===M,onChange:q(e),children:e})},e)}))]})]})]})})]})},M=function(e){var t=e.startTime,n=e.startInDelay,c=void 0===n?5:n,r=e.player,a=Object(s.useState)(!0),i=Object(o.a)(a,2),u=i[0],l=i[1],d=Object(s.useState)(c),b=Object(o.a)(d,2),f=b[0],j=b[1],v=Object(s.useMemo)((function(){return new Date(1e3*(t||0)).toISOString().substr(11,8).replace(/^00:/,"")}),[t]),h=Object(s.useCallback)((function(){r.current&&(l(!1),r.current.getVideoNode().currentTime=t)}),[t,r]),O=Object(s.useCallback)((function(){l(!1)}),[]);return Object(s.useEffect)((function(){var e;return u&&(e=setInterval((function(){j((function(e){var t=e-1;return t<=0&&h(),t}))}),1e3)),function(){clearInterval(e)}}),[u,h]),t&&u?Object(F.jsxs)("div",{className:"flex justify-center absolute w-full z-101 bottom-32",children:[Object(F.jsxs)(U.a,{onClick:h,children:["\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441 ",v," \u0447\u0435\u0440\u0435\u0437 ",f]}),Object(F.jsx)(U.a,{autoFocus:!0,onClick:O,children:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441 \u043d\u0430\u0447\u0430\u043b\u0430"})]}):null},V=["title","description","poster","audios","sources","subtitles","startTime","timeSyncInterval","onPlay","onPause","onEnded","onTimeSync"],W=function(e){var t=e.title,n=e.description,r=e.poster,l=e.audios,b=e.sources,f=e.subtitles,j=e.startTime,v=e.timeSyncInterval,h=void 0===v?30:v,O=e.onPlay,m=e.onPause,p=e.onEnded,k=e.onTimeSync,x=Object(u.a)(e,V),T=Object(s.useRef)(),g=Object(s.useState)(!1),y=Object(o.a)(g,2),C=y[0],w=y[1],N=Object(s.useState)(!0),L=Object(o.a)(N,2),A=L[0],U=L[1],B=Object(s.useCallback)((function(){U(!1),null===O||void 0===O||O()}),[O]),I=Object(s.useCallback)((function(e){U(!0),null===m||void 0===m||m(e.currentTime)}),[m]),D=Object(s.useCallback)((function(e){null===p||void 0===p||p(e.target.currentTime)}),[p]),W=Object(s.useCallback)(Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T.current||!k){e.next=5;break}return t=T.current.getVideoNode(),n=t.currentTime,e.next=5,k(n);case 5:case"end":return e.stop()}}),e)}))),[k,T]),$=Object(s.useCallback)((function(){w(!0)}),[]);return Object(s.useEffect)((function(){var e;return A&&(e=setTimeout((function(){U(!1)}),5e3)),function(){e&&clearTimeout(e)}}),[A]),Object(s.useEffect)((function(){var e;return k&&(e=setInterval(W,1e3*h)),function(){e&&clearInterval(e)}}),[h,k,W]),Object(R.a)("Back",W),Object(F.jsxs)(F.Fragment,{children:[A&&Object(F.jsx)(S.a,{className:"p-4 absolute top-0 z-10",children:t}),Object(F.jsx)(P,{showButton:A,player:T}),C&&j>0&&Object(F.jsx)(M,{startTime:j,player:T}),Object(F.jsx)(d.a,Object(c.a)(Object(c.a)({},x),{},{ref:T,title:n,poster:r,jumpBy:10,onPlay:B,onPause:I,onEnded:D,onLoadedMetadata:$,audioTracks:l,sourceTracks:b,subtitleTracks:f,videoComponent:E}))]})}}}]);
//# sourceMappingURL=20.e9f452eb.chunk.js.map