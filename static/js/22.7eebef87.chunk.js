(this["webpackJsonpkinopub.webos"]=this["webpackJsonpkinopub.webos"]||[]).push([[22],{521:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,i=n(20),c=n(525),o=n.n(c),a=n(21),u=Object(a.b)(o.a)(r||(r=Object(i.a)([""])))},529:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,i,c,o=n(6),a=n(31),u=n(20),s=n(0),l=n(231),d=n.n(l),b=n(21),f=n(107),v=n(1),j=["icon","iconOnly","children","autoFocus"],h=b.b.div(r||(r=Object(u.a)(["\n  display: inline-flex;\n\n  > div {\n    width: 100%;\n  }\n"]))),O=Object(b.b)(d.a)(i||(i=Object(u.a)(["\n  color: inherit;\n  text-decoration: none;\n"]))),p=b.b.div(c||(c=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  color: inherit;\n  text-decoration: none;\n\n  "," {\n    margin-right: ",";\n  }\n"])),f.a,(function(e){return!e.iconOnly&&"0.5rem"})),m=function(e){var t=e.icon,n=e.iconOnly,r=e.children,i=e.autoFocus,c=Object(a.a)(e,j),u=Object(s.useRef)(null);return Object(s.useEffect)((function(){var e;return i&&(e=requestAnimationFrame((function(){var e,t;null===(e=u.current)||void 0===e||null===(t=e.querySelector('[role="button"]'))||void 0===t||t.focus()}))),function(){e&&cancelAnimationFrame(e)}}),[u,i]),Object(v.jsx)(h,{ref:u,children:Object(v.jsx)(O,Object(o.a)(Object(o.a)({},c),{},{children:Object(v.jsxs)(p,{iconOnly:n,children:[t&&Object(v.jsx)(f.a,{name:t}),!n&&r]})}))})}},554:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(6),i=n(31),c=n(0),o=n(564),a=n.n(o),u=n(146),s=n(1),l=["visible","onVisibilityChange"],d=function(e){var t=e.visible,n=e.onVisibilityChange,o=Object(i.a)(e,l),d=Object(c.useCallback)((function(){n(!0)}),[n]),b=Object(c.useCallback)((function(){n(!1)}),[n]),f=Object(c.useCallback)((function(){if(t)return n(!1),!1}),[t,n]);return Object(u.a)(f),Object(s.jsx)(a.a,Object(r.a)(Object(r.a)({},o),{},{open:t,onShow:d,onClose:b}))}},565:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}));var r=n(527),i=n.n(r),c=n(102),o=n.n(c),a=n(574),u=n.n(a),s=n(586),l=n.n(s),d=function(e){return e<10?"0".concat(e):e};function b(e){return o()(e,(function(e,t){var n,r,c,o,a,u,s;return{lang:e.lang,name:i()(["".concat(d(t+1),"."),(null===(n=e.type)||void 0===n?void 0:n.title)&&(null===(r=e.author)||void 0===r?void 0:r.title)?"".concat(null===(c=e.type)||void 0===c?void 0:c.title,"."):null===(o=e.type)||void 0===o?void 0:o.title,null===(a=e.author)||void 0===a?void 0:a.title,(null===(u=e.type)||void 0===u?void 0:u.title)||(null===(s=e.author)||void 0===s?void 0:s.title)?"(".concat(l()(e.lang),")"):l()(e.lang),"aac"!==e.codec&&l()(e.codec)]).join(" ")}}))}function f(e,t){return u()(o()(e,(function(e){return{src:"string"===typeof e.url?e.url:e.url[t]||e.url.http,name:e.quality}})),(function(e){var t=e.name;return parseInt(t)}),"desc")}function v(e){return o()(e,(function(e,t){return{src:e.url,lang:e.lang,name:"".concat(l()(e.lang)," #").concat(d(t+1))}}))}},566:function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r=n(6),i=n(13),c=n.n(i),o=n(23),a=n(47),u=n(31),s=n(20),l=n(0),d=n(577),b=n.n(d),f=n(21),v=n(43),j=n(44),h=n(590),O=n(114),p=n(86),m=n(85),k=n(560),T=n.n(k),y=n(582),g=n.n(y),x=n(583),w=n.n(x),E=n(532),C=n.n(E),S=function(){function e(t){Object(v.a)(this,e),this.resource=void 0,this.objectURL=void 0,this.resource=t}return Object(j.a)(e,[{key:"blobToBuffer",value:function(){var e=this;return new Promise((function(t,n){var r=new FileReader;r.addEventListener("loadend",(function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(new Uint8Array(r))})),r.addEventListener("error",(function(){return n("Error while reading the Blob object")})),r.readAsArrayBuffer(e.resource)}))}},{key:"getURL",value:function(){var t=this;return new Promise((function(n,r){return t.resource instanceof Blob?FileReader?TextDecoder?e.blobToString(t.resource,(function(r){var i="WEBVTT FILE\r\n\r\n".concat(e.toVTT(r)),c=new Blob([i],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(c),n(t.objectURL)}),(function(){t.blobToBuffer().then((function(r){var i=new TextDecoder("utf-8").decode(r),c="WEBVTT FILE\r\n\r\n".concat(e.toVTT(i)),o=new Blob([c],{type:"text/vtt"});return t.objectURL=URL.createObjectURL(o),n(t.objectURL)}))})):r("No TextDecoder constructor found"):r("No FileReader constructor found"):r("Expecting resource to be a Blob but something else found.")}))}},{key:"release",value:function(){URL.createObjectURL(this.objectURL)}}],[{key:"blobToString",value:function(e,t,n){var r=new FileReader;r.addEventListener("loadend",(function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r)})),r.addEventListener("error",(function(){return n()})),r.readAsText(e)}},{key:"toVTT",value:function(e){return e.replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").concat("\r\n\r\n")}},{key:"toTypedArray",value:function(e){var t=[];return e.split("").forEach((function(e){t.push(parseInt("".concat(e.charCodeAt(0)),16))})),Uint8Array.from(t)}}]),e}();function L(){return(L=Object(o.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.blob();case 4:return n=e.sent,r=new S(n),e.abrupt("return",r.getURL());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R,A,U,I,F,B,V,D,N=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(v.a)(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).hls=void 0,e.media=void 0,e.state=void 0,e.props=void 0,e}return Object(j.a)(n,[{key:"load",value:function(e){var t,n=this.props.startTime;(null===(t=this.state)||void 0===t?void 0:t.src)&&this.state.src!==e&&(n=this.media.currentTime),this.destroy();var r=this.media;this.setState({src:e});var i=function(){n&&(r.currentTime=n),r.play()};if(e.includes(".m3u8")&&g.a.isSupported()){var c=this.hls=new g.a;return c.attachMedia(r),void c.on(g.a.Events.MEDIA_ATTACHED,(function(){c.loadSource(e),c.on(g.a.Events.MANIFEST_PARSED,i)}))}r.src=e,r.addEventListener("loadedmetadata",i)}},{key:"audioTracks",get:function(){var e;return this.hls?w()(this.hls.audioTracks.map((function(e){return e.name}))):null===(e=this.props.audioTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"audioTrack",get:function(){var e,t,n,r=this;if(this.hls)return null===(n=this.hls.audioTracks.find((function(e){var t;return e.id===(null===(t=r.hls)||void 0===t?void 0:t.audioTrack)})))||void 0===n?void 0:n.name;var i=Array.from(this.media.audioTracks||[]).findIndex((function(e){return e.enabled}));return null===(e=this.props.audioTracks)||void 0===e||null===(t=e[i])||void 0===t?void 0:t.name},set:function(e){if(this.hls){var t=this.hls.audioTracks.find((function(t){return t.name===e}));t&&(this.hls.audioTrack=t.id)}else{var n,r=Array.from(this.media.audioTracks||[]),i=null===(n=this.props.audioTracks)||void 0===n?void 0:n.findIndex((function(t){return t.name===e}));(!i||i>r.length-1)&&(i=0),r.forEach((function(e,t){e.enabled=t===i}))}}},{key:"sourceTracks",get:function(){return C()(this.props.sourceTracks,"src").map((function(e){return e.name}))}},{key:"sourceTrack",get:function(){var e,t=this;return null===(e=this.props.sourceTracks.find((function(e){return e.src===t.state.src})))||void 0===e?void 0:e.name},set:function(e){var t=this.props.sourceTracks.find((function(t){return t.name===e}));t&&this.load(t.src)}},{key:"subtitleTracks",get:function(){var e;return this.hls?this.hls.subtitleTracks.map((function(e){return e.name})):null===(e=this.props.subtitleTracks)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"subtitleTrack",get:function(){var e,t,n=this;return this.hls?null===(t=this.hls.subtitleTracks.find((function(e){var t;return e.id===(null===(t=n.hls)||void 0===t?void 0:t.subtitleTrack)})))||void 0===t?void 0:t.name:null===(e=Array.from(this.media.textTracks||[]).find((function(e){return"showing"===e.mode})))||void 0===e?void 0:e.label},set:function(e){if(this.hls){var t,n;this.hls.subtitleTrack=null!==(t=null===(n=this.hls.subtitleTracks.find((function(t){return t.name===e})))||void 0===n?void 0:n.id)&&void 0!==t?t:-1}else{var r=Array.from(this.media.textTracks||[]);r.forEach((function(e){e.mode="disabled"}));var i=r.find((function(t){return t.label===e}));if(i)i.mode="showing";else{var c,o=null===(c=this.props.subtitleTracks)||void 0===c?void 0:c.find((function(t){return t.name===e}));if(o){var a=document.createElement("track");a.kind="captions",a.id=o.name,a.srclang=o.lang,a.label=o.name;var u=function(e){a.src=e,a.track.mode="showing"};o.src.endsWith(".srt")?function(e){return L.apply(this,arguments)}(o.src).then(u):u(o.src),this.media.appendChild(a)}}}}},{key:"destroy",value:function(){this.hls?this.hls.destroy():this.media.src=""}},{key:"componentDidMount",value:function(){var e;this.load(this.props.sourceTracks[0].src),null===(e=Object(h.a)(Object(O.a)(n.prototype),"componentDidMount",this))||void 0===e||e.call(this)}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){var e;this.destroy(),null===(e=Object(h.a)(Object(O.a)(n.prototype),"componentWillUnmount",this))||void 0===e||e.call(this)}}]),n}(T.a),P=n(521),M=n(146),$=n(557),W=n.n($),q=n(102),z=n.n(q),J=n(554),_=n(151),H=n(1),G="NONE",K=f.b.div(R||(R=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),Q=f.b.div(A||(A=Object(s.a)(["\n  padding: 0 1rem;\n  display: flex;\n  flex-direction: column;\n"]))),X=Object(f.b)(P.a)(U||(U=Object(s.a)(["\n  width: 5rem;\n"]))),Y=f.b.div(I||(I=Object(s.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]))),Z=f.b.div(F||(F=Object(s.a)(["\n  width: ",";\n  padding-right: 1rem;\n  box-sizing: border-box;\n"])),(function(e){return e.width})),ee=function(e){var t=e.player,n=Object(l.useState)(!1),r=Object(a.a)(n,2),i=r[0],c=r[1],o=Object(l.useState)([]),u=Object(a.a)(o,2),s=u[0],d=u[1],b=Object(l.useState)(null),f=Object(a.a)(b,2),v=f[0],j=f[1],h=Object(l.useState)([]),O=Object(a.a)(h,2),p=O[0],m=O[1],k=Object(l.useState)(null),T=Object(a.a)(k,2),y=T[0],g=T[1],x=Object(l.useState)([]),w=Object(a.a)(x,2),E=w[0],C=w[1],S=Object(l.useState)(null),L=Object(a.a)(S,2),R=L[0],A=L[1],U=Object(l.useCallback)((function(e,n){t.current&&(t.current.getVideoNode()[e]=n)}),[t]),I=Object(l.useCallback)((function(e){return function(){j(e),U("audioTrack",e)}}),[U]),F=Object(l.useCallback)((function(e){return function(){g(e),U("sourceTrack",e)}}),[U]),B=Object(l.useCallback)((function(e){return function(){A(e),U("subtitleTrack",e)}}),[U]),V=Object(l.useCallback)((function(e){c(e),t.current&&!e&&t.current.play()}),[t]);return Object(l.useEffect)((function(){var e=function(e){if(Object(_.a)(e)){if(t.current){var n=t.current.getVideoNode(),r=n.audioTracks,i=n.audioTrack,o=n.sourceTracks,a=n.sourceTrack,u=n.subtitleTracks,s=n.subtitleTrack;((null===r||void 0===r?void 0:r.length)>1||(null===o||void 0===o?void 0:o.length)>1||(null===u||void 0===u?void 0:u.length)>0)&&(d(r),j(i),m(o),g(a),C(u),A(s),t.current.pause(),c(!0))}}else Object(_.b)(e)&&c(!1)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[i,t]),Object(H.jsx)(J.a,{visible:i,onVisibilityChange:V,children:Object(H.jsxs)(K,{children:[(null===s||void 0===s?void 0:s.length)>1&&Object(H.jsxs)(Q,{children:[Object(H.jsx)(X,{children:"\u0417\u0432\u0443\u043a"}),Object(H.jsx)(Y,{children:z()(s,(function(e){return Object(H.jsx)(Z,{width:"50%",children:Object(H.jsx)(W.a,{selected:e===v,onToggle:I(e),children:e})},e)}))})]}),(null===p||void 0===p?void 0:p.length)>1&&Object(H.jsxs)(Q,{children:[Object(H.jsx)(X,{children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(H.jsx)(Y,{children:z()(p,(function(e){return Object(H.jsx)(Z,{width:"15%",children:Object(H.jsx)(W.a,{selected:e===y,onToggle:F(e),children:e})},e)}))})]}),(null===E||void 0===E?void 0:E.length)>0&&Object(H.jsxs)(Q,{children:[Object(H.jsx)(X,{children:"\u0421\u0443\u0431\u0442\u0438\u0442\u0440\u044b"}),Object(H.jsxs)(Y,{children:[Object(H.jsx)(Z,{width:"15%",children:Object(H.jsx)(W.a,{selected:!R||R===G,onToggle:B(G),children:"\u041d\u0435\u0442"})}),z()(E,(function(e){return Object(H.jsx)(Z,{width:"15%",children:Object(H.jsx)(W.a,{selected:e===R,onToggle:B(e),children:e})},e)}))]})]})]})})},te=n(529),ne=f.b.div(B||(B=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  width: 100%;\n  bottom: 7rem;\n  z-index: 200;\n"]))),re=function(e){var t=e.startTime,n=e.startInDelay,r=void 0===n?5:n,i=e.player,c=Object(l.useState)(!0),o=Object(a.a)(c,2),u=o[0],s=o[1],d=Object(l.useState)(r),b=Object(a.a)(d,2),f=b[0],v=b[1],j=Object(l.useMemo)((function(){return new Date(1e3*(t||0)).toISOString().substr(11,8).replace(/^00:/,"")}),[t]),h=Object(l.useCallback)((function(){i.current&&(s(!1),i.current.getVideoNode().currentTime=t)}),[t,i]),O=Object(l.useCallback)((function(){s(!1)}),[]);return Object(l.useEffect)((function(){var e;return u&&(e=setInterval((function(){v((function(e){var t=e-1;return t<=0&&h(),t}))}),1e3)),function(){clearInterval(e)}}),[u,h]),t&&u?Object(H.jsxs)(ne,{children:[Object(H.jsxs)(te.a,{onClick:h,children:["\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441 ",j," \u0447\u0435\u0440\u0435\u0437 ",f]}),Object(H.jsx)(te.a,{autoFocus:!0,onClick:O,children:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441 \u043d\u0430\u0447\u0430\u043b\u0430"})]}):null},ie=["title","description","poster","audios","sources","subtitles","startTime","timeSyncInterval","onPlay","onPause","onEnded","onTimeSync"],ce=f.b.div(V||(V=Object(s.a)(["\n  video {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n"]))),oe=Object(f.b)(P.a)(D||(D=Object(s.a)(["\n  position: absolute;\n  padding: 0 1rem;\n  z-index: 1;\n  visibility: ",";\n"])),(function(e){return e.visible?"visible":"hidden"})),ae=function(e){var t=e.title,n=e.description,i=e.poster,s=e.audios,d=e.sources,f=e.subtitles,v=e.startTime,j=e.timeSyncInterval,h=void 0===j?30:j,O=e.onPlay,p=e.onPause,m=e.onEnded,k=e.onTimeSync,T=Object(u.a)(e,ie),y=Object(l.useRef)(),g=Object(l.useState)(!0),x=Object(a.a)(g,2),w=x[0],E=x[1],C=Object(l.useCallback)((function(){E(!1),null===O||void 0===O||O()}),[O]),S=Object(l.useCallback)((function(e){E(!0),null===p||void 0===p||p(e.currentTime)}),[p]),L=Object(l.useCallback)((function(e){null===m||void 0===m||m(e.target.currentTime)}),[m]),R=Object(l.useCallback)(Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.current||!k){e.next=5;break}return t=y.current.getVideoNode(),n=t.currentTime,e.next=5,k(n);case 5:case"end":return e.stop()}}),e)}))),[k,y]);return Object(l.useEffect)((function(){var e;return w&&(e=setTimeout((function(){E(!1)}),5e3)),function(){e&&clearTimeout(e)}}),[w]),Object(l.useEffect)((function(){var e;return k&&(e=setInterval(R,1e3*h)),function(){e&&clearInterval(e)}}),[h,k,R]),Object(M.a)(R),Object(H.jsxs)(ce,{children:[Object(H.jsx)(oe,{visible:w,children:t}),Object(H.jsx)(ee,{player:y}),v>0&&Object(H.jsx)(re,{startTime:v,player:y}),Object(H.jsx)(b.a,Object(r.a)(Object(r.a)({},T),{},{ref:y,title:n,poster:i,jumpBy:10,onPlay:C,onPause:S,onEnded:L,audioTracks:s,sourceTracks:d,subtitleTracks:f,videoComponent:N}))]})}},740:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(6),i=n(0),c=n(517),o=n(566),a=n(565),u=n(1),s=function(){var e=Object(c.e)(),t=Object(c.f)().state,n=t.item,s=t.trailer,l=Object(i.useMemo)((function(){return{title:n.title,description:"\u0422\u0440\u0435\u0439\u043b\u0435\u0440",poster:n.posters.wide||n.posters.big,sources:Object(a.b)([s])}}),[n,s]),d=Object(i.useCallback)((function(){e.goBack()}),[e]);return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(o.a,Object(r.a)(Object(r.a)({},l),{},{onEnded:d}))})}}}]);
//# sourceMappingURL=22.7eebef87.chunk.js.map